devtools::load_all(".")
gradual_Vocanol(deg_data, x = "log2FoldChange", y = "padj",
label = "row", label_number = 10)
devtools::load_all(".")
gradual_Vocanol(deg_data, x = "log2FoldChange", y = "padj",
label = "row", label_number = 10)
devtools::document()
devtools::load_all(".")
?gradual_Vocanol
devtools::document()
?geom_text_repel
usethis::use_package_doc()
devtools::document()
data("deg_data")
View(deg_data)
devtools::load_all(".")
ggvocanol(deg_data)
devtools::load_all(".")
ggvocanol(deg_data)
devtools::load_all(".")
ggvocanol(deg_data)
View(deg_data)
head(data_new)
#' @param fdr the threshold value of fdr.
#'
#' @return
#' @export
#'
#' @examples
#' head(data)
#' data_new <- add_regulate(data, log2FC_name = "log2FoldChange",
#'                          fdr_name = "padj",log2FC = 1, fdr = 0.05)
#' head(data_new)
add_regulate <- function(data, log2FC_name = "log2FoldChange",
fdr_name = "padj",
log2FC = 1, fdr = 0.05){
colnames(data)[colnames(data) == log2FC_name] <- "log2FoldChange"
colnames(data)[colnames(data) == fdr_name] <- "padj"
data$regulated <- "Normal"
loc_up <- intersect(which(data$log2FoldChange > log2FC),
which(data$padj<fdr))
loc_down <- intersect(which(data$log2FoldChange < (-log2FC)),
which(data$padj<fdr))
data$regulated[loc_up] <- "Up"
data$regulated[loc_down] <- "Down"
return(data)
}
p <- ggplot(deg_data, aes(x, -log10(y)))
p +
geom_point(aes(color = regulate), size = 0.6) +
scale_color_manual(values=c("#00AFBB","#999999","#FC4E07")) +
geom_vline(xintercept = c(-1,1), linetype ="dashed") +
geom_hline(yintercept = -log10(0.05), linetype ="dashed") +
theme(title = element_text(size = 15), text = element_text(size = 15)) +
theme_classic() +
# 添加标签：
geom_text_repel(aes(label = label, color = -log10(y)), size=3, max.overlaps = 10)+
# 修改坐标轴：
xlab(x_lab %||% "Log2FC")+
ylab(y_lab %||% "-Log10(FDR q-value)")
x_lab = NULL; y_lab = NULL,
x_lab = NULLy_lab = NULL,
x_lab = NULL
y_lab = NULL
p +
geom_point(aes(color = regulate), size = 0.6) +
scale_color_manual(values=c("#00AFBB","#999999","#FC4E07")) +
geom_vline(xintercept = c(-1,1), linetype ="dashed") +
geom_hline(yintercept = -log10(0.05), linetype ="dashed") +
theme(title = element_text(size = 15), text = element_text(size = 15)) +
theme_classic() +
# 添加标签：
geom_text_repel(aes(label = label, color = -log10(y)), size=3, max.overlaps = 10)+
# 修改坐标轴：
xlab(x_lab %||% "Log2FC")+
ylab(y_lab %||% "-Log10(FDR q-value)")
data <- deg_data
colnames(data)[colnames(data) == x] <- "x"
colnames(data)[colnames(data) == y] <- "y"
data <- deg_data
x = "log2FoldChange"
y = "padj"
colors = c("#00AFBB","#999999","#FC4E07")
x_lab = NULL
y_lab = NULL
label = "row"
label_number = 10
colnames(data)[colnames(data) == x] <- "x"
colnames(data)[colnames(data) == y] <- "y"
colnames(data)[colnames(data) == label] <- "label"
data$label <- c(data$label[1:label_number], rep("",(nrow(data)-label_number)))
p <- ggplot(data, aes(x, -log10(y)))
p <- p +
geom_point(aes(color = regulate), size = 0.6) +
scale_color_manual(values=c("#00AFBB","#999999","#FC4E07")) +
geom_vline(xintercept = c(-1,1), linetype ="dashed") +
geom_hline(yintercept = -log10(0.05), linetype ="dashed") +
theme(title = element_text(size = 15), text = element_text(size = 15)) +
theme_classic() +
# 添加标签：
geom_text_repel(aes(label = label, color = -log10(y)), size=3, max.overlaps = 10)+
# 修改坐标轴：
xlab(x_lab %||% "Log2FC")+
ylab(y_lab %||% "-Log10(FDR q-value)")
p
p +
geom_point(aes(color = regulate), size = 0.6)
p <- ggplot(data, aes(x, -log10(y)))
p +
geom_point(aes(color = regulate), size = 0.6) +
scale_color_manual(values=c("#00AFBB","#999999","#FC4E07")) +
geom_vline(xintercept = c(-1,1), linetype ="dashed") +
geom_hline(yintercept = -log10(0.05), linetype ="dashed") +
theme(title = element_text(size = 15), text = element_text(size = 15)) +
theme_classic() +
# 添加标签：
geom_text_repel(aes(label = label, color = -log10(y)), size=3, max.overlaps = 10)+
# 修改坐标轴：
xlab(x_lab %||% "Log2FC")+
ylab(y_lab %||% "-Log10(FDR q-value)")
p <- ggplot(data, aes(x, -log10(y)))
p +
geom_point(aes(color = regulate), size = 0.6)
p +
geom_point(aes(color = regulate), size = 0.6)+
scale_color_manual(values=c("#00AFBB","#999999","#FC4E07"))
p <- ggplot(data, aes(x, -log10(y)))
p +
geom_point(aes(color = regulate), size = 0.6)+
scale_color_manual(values=c("#00AFBB","#999999","#FC4E07"))+
geom_vline(xintercept = c(-1,1), linetype ="dashed") +
geom_hline(yintercept = -log10(0.05), linetype ="dashed")
p +
geom_point(aes(color = regulate), size = 0.6)+
scale_color_manual(values=c("#00AFBB","#999999","#FC4E07"))+
geom_vline(xintercept = c(-1,1), linetype ="dashed") +
geom_hline(yintercept = -log10(0.05), linetype ="dashed")+
theme(title = element_text(size = 15), text = element_text(size = 15))
devtools::load_all(".")
devtools::load_all(".")
data("deg_data")
ggvocanol(deg_data)
devtools::load_all(".")
ggvocanol(deg_data)
devtools::load_all(".")
ggvocanol(deg_data)
devtools::load_all(".")
ggvocanol(deg_data)
devtools::load_all(".")
ggvocanol(deg_data)
devtools::load_all(".")
ggvocanol(deg_data)
devtools::load_all(".")
ggvocanol(deg_data)
devtools::load_all(".")
ggvocanol(deg_data)
devtools::load_all(".")
ggvocanol(deg_data)
devtools::load_all(".")
ggvocanol(deg_data)
?guides()
devtools::load_all(".")
?guides()
devtools::load_all(".")
ggvocanol(deg_data)
devtools::load_all(".")
ggvocanol(deg_data)
devtools::load_all(".")
ggvocanol(deg_data)
devtools::load_all(".")
ggvocanol(deg_data)
ggvocanol(deg_data, add_line = F)
devtools::document()
term_data <- read.csv("term_data.csv")
View(term_data)
usethis::use_data("term_data")
usethis::use_data("term_data")
usethis::use_data(term_data)
View(term_data)
View(term_data)
deg_data2 <- read.csv("DEG.csv")
View(deg_data2)
deg_data2 <- read.csv("DEG.csv", row.names = 1)
data("deg_data")
View(deg_data)
data <- na.omit(deg_data)
View(term_data)
usethis::use_package("latex2exp")
devtools::document()
usethis::use_package("latex2exp")
devtools::document()
devtools::load_all(".")
devtools::document()
term_Vocanol(deg_data, term_data, x = "log2FoldChange", y = "padj",
label = "row", label_number = 10, output = FALSE)
devtools::load_all(".")
term_Vocanol(deg_data, term_data, x = "log2FoldChange", y = "padj",
label = "row", label_number = 10, output = FALSE)
View(term_data)
table(term_data$term)
devtools::load_all(".")
term_Vocanol(deg_data, term_data, x = "log2FoldChange", y = "padj",
label = "row", label_number = 10, output = FALSE)
devtools::load_all(".")
term_Vocanol(deg_data, term_data, x = "log2FoldChange", y = "padj",
label = "row", label_number = 10, output = FALSE)
devtools::load_all(".")
term_Vocanol(deg_data, term_data, x = "log2FoldChange", y = "padj",
label = "row", label_number = 10, output = FALSE)
devtools::load_all(".")
term_Vocanol(deg_data, term_data, x = "log2FoldChange", y = "padj",
label = "row", label_number = 10, output = FALSE)
devtools::load_all(".")
term_Vocanol(deg_data, term_data, x = "log2FoldChange", y = "padj",
label = "row", label_number = 10, output = FALSE)
devtools::load_all(".")
term_Vocanol(deg_data, term_data, x = "log2FoldChange", y = "padj",
label = "row", label_number = 10, output = FALSE)
deg_data <- deg_data[,-"regulate"]
deg_data <- deg_data[,-8]
View(deg_data)
usethis::use_data(deg_data)
usethis::use_data(deg_data, overwrite = T)
devtools::load_all(".")
deg_data <- add_regulate(deg_data)
View(deg_data)
data(term_data)
devtools::load_all(".")
usethis::use_readme_rmd()
library(ggVolcano)
devtools::load_all(".")
devtools::document()
devtools::load_all(".")
library(ggVolcano)
## basic example code
# load the data
data(deg_data)
# use the function -- add_regulate to add a regulate column
# to the DEG result data.
data <- add_regulate(deg_data, log2FC_name = "log2FoldChange",
fdr_name = "padj",log2FC = 1, fdr = 0.05)
# plot
gradual_volcano(deg_data, x = "log2FoldChange", y = "padj",
label = "row", label_number = 10, output = FALSE)
library(ggVolcano)
## basic example code
# load the data
data(deg_data)
# use the function -- add_regulate to add a regulate column
# to the DEG result data.
data <- add_regulate(deg_data, log2FC_name = "log2FoldChange",
fdr_name = "padj",log2FC = 1, fdr = 0.05)
# plot
gradual_volcano(deg_data, x = "log2FoldChange", y = "padj",
label = "row", label_number = 10, output = FALSE)
library(ggVolcano)
## basic example code
# load the data
data(deg_data)
# use the function -- add_regulate to add a regulate column
# to the DEG result data.
data <- add_regulate(deg_data, log2FC_name = "log2FoldChange",
fdr_name = "padj",log2FC = 1, fdr = 0.05)
# plot
ggvolcano(data, x = "log2FoldChange", y = "padj",
label = "row", label_number = 10, output = FALSE)
devtools::load_all(".")
library(ggVolcano)
## basic example code
# load the data
data(deg_data)
# use the function -- add_regulate to add a regulate column
# to the DEG result data.
data <- add_regulate(deg_data, log2FC_name = "log2FoldChange",
fdr_name = "padj",log2FC = 1, fdr = 0.05)
# plot
ggvolcano(data, x = "log2FoldChange", y = "padj",
label = "row", label_number = 10, output = FALSE)
library(ggVolcano)
## basic example code
# load the data
data(deg_data)
# use the function -- add_regulate to add a regulate column
# to the DEG result data.
data <- add_regulate(deg_data, log2FC_name = "log2FoldChange",
fdr_name = "padj",log2FC = 1, fdr = 0.05)
# plot
ggvolcano(data, x = "log2FoldChange", y = "padj",
label = "row", label_number = 10, output = FALSE)
# Change the fill and the color
ggvolcano(data, x = "log2FoldChange", y = "padj",
fills = c("#e94234","#b4b4d8","#269846"),
label = "row", label_number = 10, output = FALSE)
library("knitr")
knit2html("file.Rmd")
library("knitr")
knit2html("README.Rmd")
# Change the fill and the color
ggvolcano(data, x = "log2FoldChange", y = "padj",
fills = c("#e94234","#b4b4d8","#269846"),
colors = c("#e94234","#b4b4d8","#269846"),
label = "row", label_number = 10, output = FALSE)
knit2html("README.Rmd")
# Change the fill and color manually:
p1 <- ggvolcano(data, x = "log2FoldChange", y = "padj",
fills = c("#e94234","#b4b4d8","#269846"),
colors = c("#e94234","#b4b4d8","#269846"),
label = "row", label_number = 10, output = FALSE)
p2 <- ggvolcano(data, x = "log2FoldChange", y = "padj",
label = "row", label_number = 10, output = FALSE)+
ggsci::scale_color_aaas()+
ggsci::scale_fill_aaas()
library(patchwork)
p1|p2
knit2html("README.Rmd")
# plot
gradual_volcano(deg_data, x = "log2FoldChange", y = "padj",
label = "row", label_number = 10, output = FALSE)
library(RColorBrewer)
?brewer.pal()
library(RColorBrewer)
# Change the fill and color manually:
p1 <- gradual_volcano(data, x = "log2FoldChange", y = "padj",
fills = brewer.pal(5, "RdYIBu"),
colors = brewer.pal(8, "RdYIBu"),
label = "row", label_number = 10, output = FALSE)
library(RColorBrewer)
# Change the fill and color manually:
p1 <- gradual_volcano(data, x = "log2FoldChange", y = "padj",
fills = brewer.pal(5, "RdYlBu"),
colors = brewer.pal(8, "RdYlBu"),
label = "row", label_number = 10, output = FALSE)
p2 <- ggvolcano(data, x = "log2FoldChange", y = "padj",
label = "row", label_number = 10, output = FALSE)+
ggsci::scale_color_aaas()+
ggsci::scale_fill_gsea()
library(patchwork)
p1|p2
library(RColorBrewer)
# Change the fill and color manually:
p1 <- gradual_volcano(data, x = "log2FoldChange", y = "padj",
fills = brewer.pal(5, "RdYlBu"),
colors = brewer.pal(8, "RdYlBu"),
label = "row", label_number = 10, output = FALSE)
# p2 <- ggvolcano(data, x = "log2FoldChange", y = "padj",
#           label = "row", label_number = 10, output = FALSE)+
#   ggsci::scale_color_aaas()+
#   ggsci::scale_fill_gsea()
library(patchwork)
p1
library(RColorBrewer)
# Change the fill and color manually:
p1 <- gradual_volcano(data, x = "log2FoldChange", y = "padj",
fills = brewer.pal(5, "RdYlBu"),
colors = brewer.pal(8, "RdYlBu"),
label = "row", label_number = 10, output = FALSE)
p2 <- ggvolcano(data, x = "log2FoldChange", y = "padj",
label = "row", label_number = 10, output = FALSE)+
ggsci::scale_color_gsea()+
ggsci::scale_fill_gsea()
library(patchwork)
p1|p2
library(RColorBrewer)
# Change the fill and color manually:
p1 <- gradual_volcano(data, x = "log2FoldChange", y = "padj",
fills = brewer.pal(5, "RdYlBu"),
colors = brewer.pal(8, "RdYlBu"),
label = "row", label_number = 10, output = FALSE)
p2 <- ggvolcano(data, x = "log2FoldChange", y = "padj",
label = "row", label_number = 10, output = FALSE)+
ggsci::scale_color_d3()+
ggsci::scale_fill_aaas()
library(patchwork)
p1|p2
library(RColorBrewer)
# Change the fill and color manually:
p1 <- gradual_volcano(data, x = "log2FoldChange", y = "padj",
fills = brewer.pal(5, "RdYlBu"),
colors = brewer.pal(8, "RdYlBu"),
label = "row", label_number = 10, output = FALSE)
p2 <- gradual_volcano(data, x = "log2FoldChange", y = "padj",
label = "row", label_number = 10, output = FALSE)
ggsci::scale_color_gsea()+
ggsci::scale_fill_gsea()
library(RColorBrewer)
# Change the fill and color manually:
p1 <- gradual_volcano(data, x = "log2FoldChange", y = "padj",
fills = brewer.pal(5, "RdYlBu"),
colors = brewer.pal(8, "RdYlBu"),
label = "row", label_number = 10, output = FALSE)
p2 <- gradual_volcano(data, x = "log2FoldChange", y = "padj",
label = "row", label_number = 10, output = FALSE)+
ggsci::scale_color_gsea()+
ggsci::scale_fill_gsea()
library(patchwork)
p1|p2
devtools::load_all(".")
?gradual_volcano()
devtools::document()
?gradual_volcano()
devtools::document()
?gradual_volcano()
devtools::document()
?gradual_volcano()
devtools::document()
data("term_data")
# plot
term_volcano(deg_data, term_data,
x = "log2FoldChange", y = "padj",
label = "row", label_number = 10, output = FALSE)
devtools::load_all(".")
?term_Vocanol
?term_Volcano
devtools::document()
brewer.pal(5, "RdYlBu")
name(brewer.pal(5, "RdYlBu"), unique(term_data$term))
names(brewer.pal(5, "RdYlBu"), unique(term_data$term))
names(brewer.pal(5, "RdYlBu")) <- unique(term_data$term)
names(brewer.pal(5, "RdYlBu")) <- unique(term_data$term)[-"others"]
names(brewer.pal(5, "RdYlBu")) <- unique(term_data$term)[!"others"]
unique(term_data$term)
names(brewer.pal(5, "RdYlBu"))
a <- brewer.pal(5, "RdYlBu")
names(a) <- unique(term_data$term)
?ggsci::scale_color_aaas
library(RColorBrewer)
# Change the fill and color manually:
deg_point_fill <- brewer.pal(5, "RdYlBu")
names(deg_point_fill) <- unique(term_data$term)
term_volcano(data, x = "log2FoldChange", y = "padj",
normal_point_color = "#75aadb",
deg_point_fill = deg_point_fill,
deg_point_color = "grey",
label = "row", label_number = 10, output = FALSE)
data("term_data")
# plot
term_volcano(deg_data, term_data,
x = "log2FoldChange", y = "padj",
label = "row", label_number = 10, output = FALSE)
library(RColorBrewer)
# Change the fill and color manually:
deg_point_fill <- brewer.pal(5, "RdYlBu")
names(deg_point_fill) <- unique(term_data$term)
term_volcano(data, x = "log2FoldChange", y = "padj",
normal_point_color = "#75aadb",
deg_point_fill = deg_point_fill,
deg_point_color = "grey",
label = "row", label_number = 10, output = FALSE)
deg_point_fill <- brewer.pal(5, "RdYlBu")
names(deg_point_fill) <- unique(term_data$term)
library(RColorBrewer)
# Change the fill and color manually:
deg_point_fill <- brewer.pal(5, "RdYlBu")
names(deg_point_fill) <- unique(term_data$term)
term_volcano(data, x = "log2FoldChange", y = "padj",
normal_point_color = "#75aadb",
deg_point_fill = deg_point_fill,
deg_point_color = "grey",
label = "row", label_number = 10, output = FALSE)
term_volcano(data, x = "log2FoldChange", y = "padj",
normal_point_color = "#75aadb",
deg_point_fill = deg_point_fill,
deg_point_color = "grey",
label = "row", label_number = 10, output = FALSE)
colnames(term_data) <- c("geneName", "term")
View(term_data)
library(RColorBrewer)
# Change the fill and color manually:
deg_point_fill <- brewer.pal(5, "RdYlBu")
names(deg_point_fill) <- unique(term_data$term)
term_volcano(data, term_data,
x = "log2FoldChange", y = "padj",
normal_point_color = "#75aadb",
deg_point_fill = deg_point_fill,
deg_point_color = "grey",
label = "row", label_number = 10, output = FALSE)
knit2html("README.Rmd")
library(RColorBrewer)
# Change the fill and color manually:
deg_point_fill <- brewer.pal(5, "RdYlBu")
names(deg_point_fill) <- unique(term_data$term)
term_volcano(data, term_data,
x = "log2FoldChange", y = "padj",
normal_point_color = "#75aadb",
deg_point_fill = deg_point_fill,
deg_point_color = "grey",
legend_background_fill = "#41a5ee",
label = "row", label_number = 10, output = FALSE)
library(RColorBrewer)
# Change the fill and color manually:
deg_point_fill <- brewer.pal(5, "RdYlBu")
names(deg_point_fill) <- unique(term_data$term)
term_volcano(data, term_data,
x = "log2FoldChange", y = "padj",
normal_point_color = "#75aadb",
deg_point_fill = deg_point_fill,
deg_point_color = "grey",
legend_background_fill = "#a9ccf3",
label = "row", label_number = 10, output = FALSE)
knit2html("README.Rmd")
library(RColorBrewer)
# Change the fill and color manually:
deg_point_fill <- brewer.pal(5, "RdYlBu")
names(deg_point_fill) <- unique(term_data$term)
term_volcano(data, term_data,
x = "log2FoldChange", y = "padj",
normal_point_color = "#75aadb",
deg_point_fill = deg_point_fill,
deg_point_color = "grey",
legend_background_fill = "#deeffc",
label = "row", label_number = 10, output = FALSE)
knit2html("README.Rmd")
